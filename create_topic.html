<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create New Topic</title>
</head>
<body>
    <h1>Create New Topic</h1>
    <form id="topic-form">
        <label for="topic-title">Title:</label><br>
        <input type="text" id="topic-title" name="topic-title" required><br><br>
        
        <label for="topic-description">Description:</label><br>
        <textarea id="topic-description" name="topic-description" rows="4" required></textarea><br><br>
        
        <label for="topic-tags">Tags (comma-separated):</label><br>
        <input type="text" id="topic-tags" name="topic-tags" required><br><br>
        
        <button type="submit">Create Topic</button>
    </form>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.20.0/firebase-database.js"></script>
    <script src="firebase-config.js"></script>
    <script>
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        const db = firebase.database();

        // Function to handle topic creation form submission
        document.getElementById('topic-form').addEventListener('submit', function(event) {
            event.preventDefault(); // Prevent default form submission behavior

            // Get form values
            const title = document.getElementById('topic-title').value;
            const description = document.getElementById('topic-description').value;
            const tags = document.getElementById('topic-tags').value.split(',').map(tag => tag.trim());

            // Create new topic object
            const newTopicKey = db.ref().child('topics').push().key;
            const newTopic = {
                title: title,
                description: description,
                tags: tags,
                createdAt: firebase.database.ServerValue.TIMESTAMP
            };

            // Add the new topic to Realtime Database
            db.ref('topics/' + newTopicKey).set(newTopic)
                .then(() => {
                    console.log('New topic created with key:', newTopicKey);
                    // Redirect to the homepage or the newly created topic page
                    window.location.href = 'index.html'; // Change this to your desired destination
                })
                .catch((error) => {
                    console.error('Error adding topic:', error);
                    // Display error message to the user
                    alert('Error creating topic. Please try again.');
                });
        });
    </script>
</body>
</html>
